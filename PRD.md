# [未定] PRD

## プロジェクト概要

### プロジェクト名

[未定]

### ハッカソン期間

2026/2/25 〜 2026/2/26（1.5日間）

### ビジョン

ハッカソン会場の展示ブースに来た人が、ユーザーカード（NFC + QR）をかざす。スマホで自撮り写真をアップして、ガチャで衣装を引く。すると、プロジェクターに映るダンス動画の中に自分の顔がアイドルとして映っている。

「え、自分がアイドルになってる」――その体験でプロダクトの面白さが一瞬で伝わる。

---

## ターゲットと課題

### ターゲット

ハッカソン審査員、参加者、会場の観客。全員がプロダクトを初めて触る人。

### 課題

ハッカソンのデモは時間が短い。スライドや画面操作を見せるだけでは「で、何が面白いの？」で終わってしまう。体験してもらわないと価値が伝わらないタイプのプロダクトなので、来訪者が自分ごととして触れる仕組みが必要。

### 理想の体験フロー

1. カードをかざす（NFC読み取り）
2. スマホにマイページが開く
3. ガチャで衣装をゲット
4. 自撮り写真をアップロード
5. プロジェクターのダンス動画に自分の顔が映る

---

## 成功定義

- [ ] カードをかざしてからダンス動画を見るまで、一連の流れが完走する
- [ ] ガチャを引いて衣装がゲットできる
- [ ] 写真をアップロードでき、サーバーに保存される
- [ ] ダンス動画の中にアップロードした顔が映る
- [ ] ダンス動画にガチャの衣装が反映されている

---

## コア機能

| 機能               | 説明                                                                    | 優先度       | 進捗 |
| ------------------ | ----------------------------------------------------------------------- | ------------ | ---- |
| NFC読み取り        | Android端末でカードを読み取り、ユーザーを特定してプレイセッションを開始 | Must         | -    |
| ユーザー認証       | NFC UUID → DB検索 → JWT発行                                             | Must         | -    |
| マイページ         | スマホ向けWeb。ガチャ・衣装選択・写真UPの起点                           | Must         | -    |
| ガチャ             | 衣装のバーチャルカードを取得。何度でも引ける                            | Must         | -    |
| 写真アップロード   | スマホカメラで自撮り → S3に保存                                         | Must         | -    |
| 顔検出・合成       | Bedrockで顔位置を検出し、ダンス動画に合成（最大30秒以内）               | Must         | -    |
| ダンス動画表示     | プロジェクター投影（16:9）。ユーザーの顔 + 選んだ衣装で再生             | Must         | -    |
| 衣装一覧           | 獲得済み衣装の確認                                                      | Must         | -    |
| 衣装構築           | 次のゲーム用に衣装を組み合わせる                                        | Must         | -    |
| ノーツ＆スコア     | BGM同期のノーツ判定 + スコア演出                                        | Should       | -    |
| リザルト           | スコア・ランク表示                                                      | Should       | -    |
| 3Dモデルプレビュー | 衣装を着たキャラをスマホで確認                                          | Nice to Have | -    |

### 優先度の定義

- Must — これがないとデモにならない
- Should — あるとデモの質が上がる
- Nice to Have — 時間が余ったら

---

## 画面設計

### デバイス構成

```
[スマートフォン]          [プロジェクター]       [Android端末]
ユーザープロフィール ←→ ゲームプレイ画面 ←→ NFC読み取り＋管理
（Web）                （Web / 16:9）       （Web NFC API）
```

### ユーザープロフィール画面（スマホ・Web）

来訪者が自分のスマホで操作する画面。QRコードからアクセス。

- マイページ：名前・スコア・メニュー
- ガチャ：タップで衣装ゲット
- 衣装一覧：獲得済み衣装の確認
- 衣装構築：次のゲーム用にセットを組む
- 写真アップロード：カメラ起動 → 撮影 → アップロード
- 3Dモデルプレビュー（Nice to Have）：衣装を着たキャラの確認

### ゲームプレイ画面（プロジェクター・Web）

プロジェクターに投影する大画面。16:9。

- ユーザーの顔が合成されたダンス動画
- ノーツ判定 + スコア表示（Should）
- リザルト画面（Should）

### NFC読み取り・管理画面（Android・Web）

スタッフが操作する端末。NFC読み取りとセットアップを兼ねる。

- NFCタグ読み取り → ユーザー特定 → プレイセッション作成
- Socket.IO でゲームプレイ画面にリアルタイム通知
- 管理モード：NFCタグUUID ↔ ユーザーIDのマッピング登録・一覧・削除

---

## 技術スタック

| コンポーネント       | 技術                               | 選定理由                                                                       |
| -------------------- | ---------------------------------- | ------------------------------------------------------------------------------ |
| フロント・バック統合 | TanStack Start（React + Vite）     | 同じTypeScriptコードでフロント・バック両方書ける。Three.jsへの移行も視野に入る |
| バックエンド実行環境 | Node.js on EC2                     | WebSocket（Socket.IO）をネイティブに使える                                     |
| リアルタイム通信     | Socket.IO                          | NFC端末 → ゲーム画面のセッション同期                                           |
| データベース         | DynamoDB                           | AWSネイティブ。管理コストが低い                                                |
| AI処理               | AWS Bedrock                        | 顔検出にVisionモデルを使う。Bedrockから呼べるモデルに限定                      |
| ファイル保存         | S3                                 | 写真の保存とCDN配信                                                            |
| デプロイ             | Amplify（フロント）+ EC2（バック） | —                                                                              |
| NFC                  | Web NFC API                        | Chrome Androidでそのまま動く                                                   |
| 認証                 | JWT                                | NFC UUID → ユーザー特定後にトークン発行                                        |

### アーキテクチャ方針

TanStack Startを選んだのは、フロント・バックが同じ TypeScript で書けるから。3人のチームで誰でもどこでも手を出せるようにしたい。

通信はSocket.IOで統一。NFC端末がカードを読んだらSocket.IO経由でゲーム画面にセッション開始を通知する。

動画合成の具体的な実装方法（FFmpeg.js / Three.js / サーバー側処理）は開発初日に決める。

---

## 制約

- 開発期間：1.5日（2026/2/25〜26）
- チーム：3名
- プロジェクター：16:9
- NFC：Web NFC API（Chrome Android）
- AI：AWS Bedrockから呼べるモデルのみ
- デプロイ：AWSのみ
- 顔合成の処理時間：最大30秒

---

## 未確定事項

### 初日に決める

- [ ] 動画合成の実装方法（FFmpeg.js / Three.js / サーバー側処理）
- [ ] Socket.IOのイベント仕様（NFC端末 ↔ ゲーム画面のデータ形式）
- [ ] DynamoDBのテーブル設計

### 開発中に決める

- [ ] 各画面の詳細デザイン
- [ ] ガチャの演出・確率・衣装の種類
- [ ] プロジェクト正式名

---

最終更新: 2026-02-24
